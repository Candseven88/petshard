# APIè°ƒç”¨é—®é¢˜æ•…éšœæ’é™¤æŒ‡å—

## ğŸ” å½“å‰é—®é¢˜

**é”™è¯¯ç **: 1210  
**é”™è¯¯ä¿¡æ¯**: "API è°ƒç”¨å‚æ•°æœ‰è¯¯ï¼Œè¯·æ£€æŸ¥æ–‡æ¡£"

## âœ… å·²å®Œæˆçš„ä¿®å¤

### 1. APIé…ç½® 
- âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡è¯»å–API URL
- âœ… ç§»é™¤ `max_tokens` å‚æ•°ï¼ˆglm-4v-flashå¯èƒ½ä¸æ”¯æŒï¼‰
- âœ… æ·»åŠ è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—

### 2. é¡µé¢å¸ƒå±€
- âœ… æ·»åŠ Layoutç»„ä»¶ï¼ˆHeaderå’ŒFooterç°åœ¨æ˜¾ç¤ºï¼‰
- âœ… ç®€å†é£æ ¼å¡ç‰‡å¸ƒå±€

### 3. ä¸‹è½½åŠŸèƒ½
- âœ… å®‰è£…html2canvasåº“
- âœ… ä¿®å¤TypeScriptç±»å‹é”™è¯¯
- âœ… æ·»åŠ é”™è¯¯å¤„ç†

### 4. åˆ†äº«åŠŸèƒ½
- âœ… æ”¹è¿›å¤šå±‚é™çº§å¤„ç†
- âœ… æ›´å¥½çš„ç”¨æˆ·åé¦ˆ

## ğŸ”§ éœ€è¦æ£€æŸ¥çš„APIå‚æ•°

æ ¹æ®æ™ºè°±AIæ–‡æ¡£ï¼Œglm-4v-flashçš„æ­£ç¡®è°ƒç”¨æ ¼å¼åº”è¯¥æ˜¯ï¼š

```javascript
{
  "model": "glm-4v-flash",
  "messages": [
    {
      "role": "user",
      "content": [
        {
          "type": "image_url",
          "image_url": {
            "url": "data:image/jpeg;base64,..."
          }
        },
        {
          "type": "text",
          "text": "prompt text"
        }
      ]
    }
  ]
}
```

## ğŸ§ª å¯èƒ½çš„é—®é¢˜åŸå› 

### 1. å›¾ç‰‡æ ¼å¼é—®é¢˜
- **æ£€æŸ¥**: Base64ç¼–ç æ˜¯å¦æ­£ç¡®
- **æµ‹è¯•**: å°è¯•ä¸Šä¼ ä¸åŒæ ¼å¼çš„å›¾ç‰‡ï¼ˆJPG, PNGï¼‰
- **é™åˆ¶**: ç¡®ä¿å›¾ç‰‡å°äº5MB

### 2. æ¨¡å‹åç§°é—®é¢˜
å¯èƒ½éœ€è¦å°è¯•çš„æ¨¡å‹åç§°ï¼š
- âœ… `glm-4v-flash` (å½“å‰ä½¿ç”¨)
- ğŸ”„ `GLM-4V-Flash` (å¤§å†™)
- ğŸ”„ `glm-4v` (ç®€åŒ–ç‰ˆæœ¬)

### 3. APIå¯†é’¥é—®é¢˜
- **éªŒè¯**: ç¡®è®¤API Keyæ²¡æœ‰è¿‡æœŸ
- **æƒé™**: æ£€æŸ¥æ˜¯å¦æœ‰è®¿é—®glm-4v-flashçš„æƒé™
- **æ ¼å¼**: ç¡®ä¿æ²¡æœ‰é¢å¤–çš„ç©ºæ ¼æˆ–æ¢è¡Œç¬¦

### 4. è¯·æ±‚å‚æ•°é—®é¢˜
å½“å‰ç§»é™¤çš„å‚æ•°ï¼š
- âŒ `max_tokens` - glm-4v-flashå¯èƒ½ä¸æ”¯æŒ

ä¿ç•™çš„å‚æ•°ï¼š
- âœ… `temperature: 0.7`
- âœ… `top_p: 0.8`

## ğŸ“‹ ä¸‹ä¸€æ­¥æµ‹è¯•æ­¥éª¤

### æµ‹è¯•1ï¼šéªŒè¯APIå¯†é’¥
```bash
curl -X POST https://open.bigmodel.cn/api/paas/v4/chat/completions \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "glm-4v-flash",
    "messages": [
      {
        "role": "user",
        "content": "Hello"
      }
    ]
  }'
```

### æµ‹è¯•2ï¼šå°è¯•ä¸åŒæ¨¡å‹
åœ¨ `route.ts` ä¸­å°è¯•ï¼š
```typescript
// é€‰é¡¹1ï¼šä½¿ç”¨glm-4v-plusï¼ˆå·²çŸ¥å¯ç”¨ï¼‰
model: 'glm-4v-plus-0111'

// é€‰é¡¹2ï¼šä½¿ç”¨glm-4.5v
model: 'glm-4.5v'
```

### æµ‹è¯•3ï¼šç®€åŒ–è¯·æ±‚
ç§»é™¤æ‰€æœ‰å¯é€‰å‚æ•°ï¼Œåªä¿ç•™å¿…éœ€çš„ï¼š
```typescript
const requestBody = {
  model: 'glm-4v-flash',
  messages: [
    {
      role: 'user',
      content: [
        { type: 'image_url', image_url: { url: imageUrl } },
        { type: 'text', text: prompt }
      ]
    }
  ]
};
```

## ğŸ”„ ä¸´æ—¶è§£å†³æ–¹æ¡ˆ

å¦‚æœAPIæŒç»­å¤±è´¥ï¼Œå¯ä»¥ï¼š

### æ–¹æ¡ˆ1ï¼šä½¿ç”¨å·²çŸ¥å¯ç”¨çš„æ¨¡å‹
```typescript
// åœ¨ /src/app/api/pet-naming/route.ts ç¬¬256è¡Œ
model: 'glm-4v-plus-0111'  // æ›¿ä»£ glm-4v-flash
```

### æ–¹æ¡ˆ2ï¼šè”ç³»æ™ºè°±AIæ”¯æŒ
- ç¡®è®¤glm-4v-flashçš„æ­£ç¡®è°ƒç”¨æ–¹å¼
- æ£€æŸ¥è´¦æˆ·æ˜¯å¦æœ‰æƒé™ä½¿ç”¨è¯¥æ¨¡å‹
- è·å–å…·ä½“çš„å‚æ•°è¦æ±‚

## ğŸ“Š æ—¥å¿—åˆ†æ

ä»ç»ˆç«¯æ—¥å¿—ä¸­æŸ¥çœ‹ï¼š
```
Processing image file...
Calling GLM-4V-Flash API...
API URL: https://open.bigmodel.cn/api/paas/v4/chat/completions
Model: glm-4v-flash
API Response status: 400
API error: {"error":{"code":"1210","message":"API è°ƒç”¨å‚æ•°æœ‰è¯¯"}}
```

**åˆ†æ**ï¼š
- âœ… API URLæ­£ç¡®
- âœ… æ¨¡å‹åç§°å·²ä¼ é€’
- âŒ å‚æ•°æ ¼å¼å¯èƒ½ä¸æ­£ç¡®

## ğŸ’¡ å»ºè®®çš„ä¿®å¤é¡ºåº

1. **é¦–å…ˆ**: å°è¯•ä½¿ç”¨glm-4v-plus-0111ï¼ˆå·²çŸ¥å¯ç”¨ï¼‰
2. **å…¶æ¬¡**: æ£€æŸ¥æ™ºè°±AIæ§åˆ¶å°çš„æ¨¡å‹æƒé™
3. **ç„¶å**: è”ç³»æ™ºè°±AIæŠ€æœ¯æ”¯æŒ
4. **æœ€å**: ç­‰å¾…å®˜æ–¹æ–‡æ¡£æ›´æ–°æˆ–æ”¯æŒå›å¤

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé—®é¢˜æŒç»­ï¼š
1. æŸ¥çœ‹æ™ºè°±AIå®˜æ–¹æ–‡æ¡£ï¼šhttps://open.bigmodel.cn/dev/api
2. è®¿é—®æ™ºè°±AIæ§åˆ¶å°æ£€æŸ¥æ¨¡å‹æƒé™
3. è”ç³»æ™ºè°±AIæŠ€æœ¯æ”¯æŒ

---

**æœ€åæ›´æ–°**: 2025-01-25  
**çŠ¶æ€**: ç­‰å¾…APIæµ‹è¯•ç»“æœ
